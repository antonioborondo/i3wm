#!/usr/bin/env python

# Run the following command in a shell once to make it work:
#
# sudo apt install python3 python-is-python3
# systemctl --user daemon-reload
# systemctl --user start i3-output.service
#
# Check that the service is running with:
#
# systemctl --user status i3-output.service

import time
import subprocess
from outputs import Outputs


def main():
    outputs_number = 1  # Laptop

    while True:
        outputs = Outputs()

        outputs_number_changed = False
        new_outputs_number = len(outputs)
        if new_outputs_number != outputs_number:
            outputs_number = new_outputs_number
            outputs_number_changed = True

        if outputs_number_changed or not outputs.has_enabled():
            command = "i3-output --type auto"
            subprocess.run(command, shell=True)

        time.sleep(5)


if __name__ == "__main__":
    main()
